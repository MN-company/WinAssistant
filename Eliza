@echo off
:: STARTUP
title Eliza
set ElizaVer=1.2.5
set speech=start scripts\nircmd.exe speak text
VER | findstr /i "5.1." > nul
IF %ERRORLEVEL% EQU 0 set version=xp
VER | findstr /i "6.1." > nul
IF %ERRORLEVEL% EQU 0 set version=w7
color %color%
setlocal
goto Check-Skip-dir

:Check-Skip-dir
if exist Skip-File (goto Skip-Simple-setting-avv) else (goto Create-skip-dir)

:Create-skip-dir
mkdir "Skip-File"
cd Skip-File
echo avvio > avvio.xavv
goto Skip-Simple-setting

:restart
cd..
echo                                                     ----------------------- 
echo                                                       Logged in as: %username%
echo                                                     -----------------------
echo.
echo                                   Eliza
echo                                   -----------
echo                      New Reinvented Windows Assistant
echo                          ------      %ElizaVer%      ------
echo                                     -------
echo                                  RELEASE VERSION
echo                                     -------
echo.
echo.
echo.
echo.
:newvoice
echo.
pause
goto start

:Skip-Simple-setting-avv
cd Skip-File
if exist "simple-setting.xconfig" (goto Skip-simple-setting-dimension) else (goto simple-setting)
echo.

:Skip-Simple-setting
if exist "simple-setting.xconfig" (goto Skip-simple-setting-dimension) else (goto simple-setting)
echo.

:Skip-simple-setting-dimension
if exist "simple-setting-1.xconfig" (goto setdim-1-all) else (goto setdim-2-all)
echo.

:simple-setting
echo.
echo Seleziona lo stile che ti piace:
echo.
echo 51, 44 (In stile Cortana)
echo Defoult (Grandezza di defoult)
choice /c 12 /n
if %errorlevel% == 1 goto setdim-1
if %errorlevel% == 2 goto setdim-2

:setdim-1
set XYZ=51, 44
echo %XYZ% > simple-setting-1.xconfig
echo Simple-setting > simple-setting.xconfig
goto Skip-Simple-setting

:setdim-2
set XYZ=120, 30
echo %XYZ% > simple-setting-2.xconfig
echo Simple-setting > simple-setting.xconfig
goto Skip-Simple-setting

:setdim-1-all
set XYZ=51, 44
goto Skip-change-color

:setdim-2-all
set XYZ=120, 30
echo restart > set-start-2.xconfig
goto Skip-change-color

:simple-setting-color
echo.
echo Seleziona lo stile che ti piace:
echo.
echo Sfondo nero; Scritte blu
echo Sfondo nero; Scritte gialle
echo.
choice /c 123 /n
if %errorlevel% == 1 goto color-b
if %errorlevel% == 2 goto color-e

:Skip-change-color
if exist "color-setting.xconfig" (goto Color-G-P) else (goto simple-setting-color)

:color-b
set color=B
echo %color% > select-color-b.xconfig
echo color-setting > color-setting.xconfig
goto Skip-change-color

:color-e
set color=E
echo %color% > select-color-e.xconfig
echo color-setting > color-setting.xconfig
goto Skip-change-color

:Color-G-P
if exist "select-color-b.xconfig" (goto color-B) else (goto color-E)

:color-B
set color=B
cd..
goto Skip-check-eta-1

:color-E
set color=E
cd..
goto Skip-check-eta-1

:user-eta
echo.
cd..
echo Seleziona l'opzione più adatta a te:
echo.
echo Sono minorenne
echo Sono maggiorenne
echo.
choice /c 12 /n
if %errorlevel% == 1 goto minorenne-1
if %errorlevel% == 2 goto maggiorenne-1

:Skip-check-eta-1
echo.
cd Skip-File
if not exist "user-underage.xconfig" (goto Skip-check-eta-2) else (goto set-eta-17)

:Skip-check-eta-2
echo.
cd Skip-File
if not exist "user-adult.xconfig" (goto user-eta) else (goto set-eta-18)

:minorenne-1
echo.
cd Skip-File
if not exist "user-underage.xconfig" (goto minorenne-2) else (goto Skip-check-eta-1)

:minorenne-2
echo eta=17 > user-underage.xconfig
goto set-eta-17

:set-eta-18
set ETA=18
cd..
goto username

:set-eta-17
set ETA=17
cd..
goto username

:maggiorenne-1
echo.
cd Skip-File
if not exist "user-adult.xconfig" (goto maggiorenne-2) else (goto Skip-check-eta-1)

:maggiorenne-2
echo eta=18 > user-adult.xconfig
goto set-eta-18

:username
cd Skip-File
if exist "username-nickname.txt" (goto startonwake) else (goto username-2)

:username-2
echo.
set/p "user=Inserisci il tuo Username: "
if '%user%' == '' echo Username non valido. Inserisci un Username valido. && pause && goto username
choice /c SN /m "Confermi il tuo Username '%user%' ?"
if %errorlevel% == 2 goto mailclient
echo %user% > username-nickname.txt
echo Username confermato.

:mailclient
echo.
if not exist "mail-client.txt" (goto mailclient-1) else (goto browserclient)
echo.

:mailclient-1
echo.
echo Bene %user%, seleziona il client di mail che usi:
echo.
echo Gmail
echo Outlook
echo Posta Windows 10
echo Yahoo Mail
echo Libero Mail
echo Mozzilla Thunderbird
echo Nessuno di questi
echo.
echo MClient > mail-client.txt
choice /c 1234567 /n
if %errorlevel% == 1 set MClient=gmail
if %errorlevel% == 2 set MClient=outlook
if %errorlevel% == 3 set MClient=posta
if %errorlevel% == 4 set MClient=yahoo
if %errorlevel% == 5 set MClient=libero
if %errorlevel% == 6 set MClient=thunderbird
if %errorlevel% == 7 set MClient=other
goto mailclient

:browserclient
echo.
if not exist "browser-client.txt" (goto browserclient-1) else (goto startonwake)
echo.

:browserclient-1
echo.
echo Bene %user%, seleziona il tuo browser preferito:
echo.
echo Microsoft Edge
echo Google Chrome
echo CryptoTab Browser
echo Brave
echo Opera
echo Opera Gaming
echo Tor Browser
echo Nessuno di questi
echo.
echo BrowserClient > browser-client.txt
choice /c 12345678 /nif %errorlevel% == 1 set BrowserClient=edge
if %errorlevel% == 2 set BrowserClient=chrome
if %errorlevel% == 3 set BrowserClient=cryptotab
if %errorlevel% == 4 set BrowserClient=brave
if %errorlevel% == 5 set BrowserClient=opera
if %errorlevel% == 6 set BrowserClient=operagaming
if %errorlevel% == 7 set BrowserClient=tor
if %errorlevel% == 8 set BrowserClient=other
goto browserclient

:startonwake
cd..
mode %XYZ%
color %color%
set/p user=<"C:\Users\gioia\OneDrive\Desktop\WinAssistant\Skip-File\username-nickname.txt"
cd Skip-File
echo %MClient% > mail-client.txt
echo %BrowserClient% > browser-client.txt
cd..
echo Ciao %user%, cosa posso fare per te?
%speech% "Ottimo %user%, come posso esseri utile?"
goto start

:start
echo.
set /p C=Chiedi a Eliza: 
echo.
if "%C%"=="jarvis" goto jarvis
if "%C%"=="introduce" goto introduce
if "%C%"=="mute" goto mute
if "%C%"=="muto" goto mute
if "%C%"=="muto!" goto mute
if "%C%"=="mutati" goto mute
if "%C%"=="stai zitto" goto mute
if "%C%"=="stai zitto!" goto mute
if "%C%"=="Stai zitto" goto mute
if "%C%"=="Stai zitto!" goto mute
if "%C%"=="Fai silenzio" goto mute
if "%C%"=="Fai silenzio!" goto mute
if "%C%"=="fai silenzio!" goto mute
if "%C%"=="fai silenzio!" goto mute
if "%C%"=="unmute" goto unmute
if "%C%"=="smutati" goto unmute
if "%C%"=="Smutati" goto unmute
if "%C%"=="Smutati!" goto unmute
if "%C%"=="smutati!" goto unmute
if "%C%"=="Ripristina il volume" goto unmute
if "%C%"=="Ripristina il volume!" goto unmute
if "%C%"=="ripristina il volume" goto unmute
if "%C%"=="Attiva il volume" goto unmute
if "%C%"=="Attiva il volume!" goto unmute
if "%C%"=="attiva il volume" goto unmute
if "%C%"=="attiva il volume!" goto unmute
if "%C%"=="shutdown" goto shutdown
if "%C%"=="spegni" goto shutdown
if "%C%"=="buonanotte" goto shutdown
if "%C%"=="Buonanotte" goto shutdown
if "%C%"=="buonanotte!" goto shutdown
if "%C%"=="Buonanotte!" goto shutdown
if "%C%"=="notte" goto shutdown
if "%C%"=="Notte" goto shutdown
if "%C%"=="notte!" goto shutdown
if "%C%"=="Notte!" goto shutdown
if "%C%"=="killtask" goto killtask
if "%C%"=="volumeup" goto volup
if "%C%"=="volumedown" goto voldown
if "%C%"=="volumemax" up goto volmax
if "%C%"=="help" goto help
if "%C%"=="self destruct" goto autodelete
if "%C%"=="suicide" goto autodelete
if "%C%"=="spitshine" goto fuckoffsir
if "%C%"=="cmd" goto cmd
if "%C%"=="time" goto time
if "%C%"=="date" goto %version%date
if "%C%"=="time and date" goto %version%dat
if "%C%"=="program" goto program
if "%C%"=="tasklist" goto tasklist
if "%C%"=="alarm" goto alarm
if "%C%"=="spotify" goto Spotify
if "%C%"=="playlists" goto playlists
if "%C%"=="mos" goto mos
if "%C%"=="lock" goto lock
if "%C%"=="msnstat" goto msnstat
if "%C%"=="sendim" goto sendim
if "%C%"=="msnbrowse" goto msnbrowse
if "%C%"=="close" goto close
if "%C%"=="off out" goto offout
if "%C%"=="im back" goto imback
if "%C%"=="killmos" goto killmos
if "%C%"=="thankyou" goto thankyou2
if "%C%"=="voice" goto voicemode
if "%C%"=="speak" goto speak
if "%C%"=="version" goto version
if "%C%"=="" goto start
if "%C%"=="new" start jarvis.exe && goto start
if "%C%"=="weather" goto weather
if "%C%"=="screen off" goto screenoff
if "%C%"=="screensaver" goto screensaver
if "%C%"=="dim" goto dim
if "%C%"=="dim stop" goto dimstop
if "%C%"=="forecast" goto forecast
if "%C%"=="news" goto news
if "%C%"=="contact us" (echo Please email us at: "jarviscmd@gmail.com" to ask us any questions!) && goto start
if "%C%"=="restart" cls && call jarvis.bat
if "%C%"=="set" %speech% Security breach detected. Access denied. && goto start
if "%C%"=="set " %speech% Security breach detected. Access denied. && goto start
if "%C%"=="goto suicide" %speech% Security flaw detected. Access denied. && goto start
::WHEN ADDING NEW COMMAND IT MUST START: if "%C%"=="command"
%C%
goto start

:mute
call scripts\nircmd.exe mutesysvolume 2
echo Ok imposto volume su 0.
goto start

:unmute
call scripts\nircmd.exe mutesysvolume 2
echo Ok, ho riportato il volume com'era prima!
%speech% "Ok, ho ripristinato il volume!"
goto start

:introduce
echo.
%speech% "Ciao %username%, mi chiamo Eliza. Sono una VLA, un Virual Life Assistant. La mia funzione principale è assistere l'utente in ogni modo possibile per semplificare la vita quotidiana."
echo Ciao %username%, mi chiamo Eliza. Sono una VLA, un Virual Life Assistant. La mia funzione principale è assistere l'utente in ogni modo possibile per semplificare la vita quotidiana.
echo Sono stata creata e concepita dal mio creatore Paolo Gobber, per rimpiazzare Cortana un assistente
echo privo di funzioni essenziali per un lavoro ottimale in Windows.
echo Un obbiettivo che è stato usato per crearmi era ed è quello di tenere al sicuro i dati degli utenti
echo grazie a protezioni multilivello, ho liste di siti bloccati che vengono ritenuti fraudolenti o dannosi per i dati degli utenti
echo e tutti i dati che vengono chiesti alla prima configurazione come l'età verrà usata solo in locale per eseguire controlli di sicurezza.
echo Per esempio se hai dichiarato di essere minorenne non potrai accedere a siti per soli maggiorenni, e questo permette
echo di tenere al sicuro tutti gli utenti che mi utilizzano.
echo.
echo Il codice NON è open source perciò per modificarlo devi essere registrato al programma Developer Enterprise Build.
echo Se vuoi vedere novità in anteprima ti consiglio di registrarti al programma Public Beta Tester,
echo mentre se vuoi dare un aiuto più concreto puoi registrarti al programma Enterprise Build Tester 
echo.
echo Se vuoi saperne di più:
echo 1=Link al programma Developer Enterprise Build
echo 2=Link al programma Public Beta Tester
echo 3=Link al programma Enterprise Build Tester
echo 4=Torna a start senza interessarti di nulla
choice /c 1234 /n
if %errorlevel% == 1 goto DeveloperEnterpriseBuild
if %errorlevel% == 2 goto PublicBetaTester
if %errorlevel% == 3 goto EnterpriseBuildTester
if %errorlevel% == 4 goto scherzo-tastiera

:DeveloperEnterpriseBuild
explorer www.google.it
goto start

:PublicBetaTester
explorer www.google.it
goto start

:EnterpriseBuildTester
explorer www.google.it
goto start

:scherzo-tastiera
echo.
color C
echo Ops, piccolo scherzetto! :)
goto start

:shutdown
echo Buona notte %username%, a domani!.
%speech% "Buona notte %username%, a domani!"
shutdown -s -t 20
echo.
pause
EXIT

:killtask
echo Per favore specificami il nome del processo che vuoi arrestare. (nome.exe)
set /p procname=
taskkill /IM %procname%
echo Ho arrestato il processo desiderato.
goto start

:volup
start scripts\nircmd.exe changesysvolume 13107
echo Ho aumentato il volume del 20%.
goto start

:voldown
start scripts\nircmd.exe changesysvolume -13107
echo Ho diminuito del 20 % il volume.
goto start

:volmax
start scripts\nircmd.exe setsysvolume 65535
echo Ho impostato il volume al massimo.
goto start
echo.

:help
echo Available commands:
echo jarvis (also "hello there jarvis"
echo introduce
echo mute
echo unmute
echo killtask
echo shutdown
echo volumeup
echo volumedown
echo volumemax
echo help
echo self destruct (also "suicide")
echo spitshine
echo cmd
echo time
echo date
echo time and date
echo program
echo tasklist
echo alarm
echo spotify
echo playlists
echo mos
echo lock
echo msnstat
echo msnbrowse
echo sendim
echo close (also exit)
echo off out
echo im back
echo killmos
echo thankyou
echo voice
echo speak
echo version
echo new
echo news
echo weather
echo forecast
echo screen off
echo screensaver
echo dim
echo dim stop
echo contact us
echo restart
echo.
echo For more information please read the readme file.
goto start

:fuckoffsir
echo I'm sorry %user%, have you been on the drugs again? Kindly shut the fuck up sir. :)
%speech% "I'm sorry sir, have you been on the drugs again? Kindly shut the fuck up sir."
goto start

:cmd
echo Ho aperto il promt dei comandi in una nuova finestra!
%speech% "Ho avviato il promt dei comandi in una nuova finestra"
start scripts\cmd.bat
goto start


:time
echo Sono le %time% %user%
%speech% "Sono le %time% , %user%"
goto start

::date

:w7date
set dateyear=%date:~-4%
if %date:~-7,-5%==01 set datemonth=January
if %date:~-7,-5%==02 set datemonth=February
if %date:~-7,-5%==03 set datemonth=March
if %date:~-7,-5%==04 set datemonth=April
if %date:~-7,-5%==05 set datemonth=May
if %date:~-7,-5%==06 set datemonth=June
if %date:~-7,-5%==07 set datemonth=July
if %date:~-7,-5%==08 set datemonth=August
if %date:~-7,-5%==09 set datemonth=September
if %date:~-7,-5%==10 set datemonth=October
if %date:~-7,-5%==11 set datemonth=November
if %date:~-7,-5%==12 set datemonth=December
set dateday=%date:~-10,-8%

echo It is %dateday% %datemonth% %dateyear%, sir.
%speech% "It is %dateday% %datemonth% %dateyear%, sir."
::echo The current date is %date% sir | clip
::start scripts\nircmd.exe speak text ~$clipboard$
goto start

:xpdate
echo It is %date%, sir.
%speech% "It is %date%, sir."
goto start

:w7dat
if %time:~0,-9% GTR 12 (set /a timehour=%time:~0,-9%-12) else set timehour=%time:~0,-9%
if %time:~3,1%==0 (set timeminute=%time:~4,1%) else set timeminute=%time:~3,2%

set dateyear=%date:~-4%
if %date:~-7,-5%==01 set datemonth=January
if %date:~-7,-5%==02 set datemonth=February
if %date:~-7,-5%==03 set datemonth=March
if %date:~-7,-5%==04 set datemonth=April
if %date:~-7,-5%==05 set datemonth=May
if %date:~-7,-5%==06 set datemonth=June
if %date:~-7,-5%==07 set datemonth=July
if %date:~-7,-5%==08 set datemonth=August
if %date:~-7,-5%==09 set datemonth=September
if %date:~-7,-5%==10 set datemonth=October
if %date:~-7,-5%==11 set datemonth=November
if %date:~-7,-5%==12 set datemonth=December
set dateday=%date:~-10,-8%

echo It is currently %timeminute% minutes past %timehour% on %dateday% %datemonth% %dateyear%, sir.
%speech% "It is currently %timeminute% minutes past %timehour% on %dateday% %datemonth% %dateyear%, sir."
::echo The current time and date is %time% on the %date% sir | clip
::start scripts\nircmd.exe speak text ~$clipboard$
goto start

:xpdat
if %time:~0,-9% GTR 12 (set /a timehour=%time:~0,-9%-12) else set timehour=%time:~0,-9%
if %time:~3,1%==0 (set timeminute=%time:~4,1%) else set timeminute=%time:~3,2%

echo It is currently %timeminute% minutes past %timehour% on %date%, sir.
%speech% "It is currently %timeminute% minutes past %timehour% on %date%, sir."
goto start

:program
set /p program=Quale programma vuoi aprire?
echo.
if %program%==firefox goto openfirefox
if %program%==msn goto openMSN
if %program%==spotify goto openspotify
if %program%==notepad goto opennotepad
if %program%==word goto openword
if %program%==excel goto openexcel
if %program%==powerpoint goto openpowerpoint
if %program%==access goto openaccess
if %program%==mail goto openmail
if %program%==publisher goto openpublisher
if %program%==onenote goto openonenote
if %program%==notion goto opennotion
if %program%==browser goto openbrowser DA FARE: motore di ricerca predefinito 
if %program%==start goto start
if %program%==other goto openother
else Unknown program. Please try again.
goto program

:openfirefox
start firefox.exe
echo Firefox aperto con successo!
%speech% "Firefox aperto con successo"
goto start

:openpowerpoint
start POWERPNT.exe
echo Powerpoint aperto con successo!
%speech% "Powerpoint aperto con successo"
goto start

:openexcel
start EXCEL.exe
echo Excel aperto con successo!
%speech% "Excel aperto con successo"
goto start

:openword
start WINWORD.exe
echo Word aperto con successo!
%speech% "Word aperto con successo"
goto start

:openaccess
start MSACCESS.exe
echo Access aperto con successo!
%speech% "Access aperto con successo"
goto start

:openpublisher
start MSPUB.exe
echo Publisher aperto con successo!
%speech% "Publisher aperto con successo"
goto start

:openmail
start %MClient%
echo Mail aperto con successo!
%speech% "Mail aperto con successo"
goto start

:openonenote
start ONENOTE.exe
echo Onenote aperto con successo!
%speech% "Onenote aperto con successo"
goto start

:opennotion
start Notion.exe
echo Notion aperto con successo!
%speech% "Notion aperto con successo"
goto start

:opennotion
start Notion.exe
echo Notion aperto con successo!
%speech% "Notion aperto con successo"
goto start

:openonenote
start Notion.exe
echo Notion aperto con successo!
%speech% "Notion aperto con successo"
goto start

:openMSN
start "C:\program files\windows live\messenger\msnmsgr.exe"
echo Windows Live Messenger should now have opened, sir.
goto start

:openspotify
start "C:\program files\spotify\spotify.exe"
echo Spotify should now have opened, sir.
goto start

:opennotepad
start notepad.exe
echo Notepad should now have opened, sir.
goto start

:openother
echo.
echo Please type the directory of the program, sir.
set /p progdir=
start %progdir%
echo The program you requested should now have opened, sir.
goto start

:tasklist
echo Current running processes are now been displayed on my screen, sir.
tasklist
goto start

::ALARM

:alarm
echo What time will you be getting up tomorrow, sir? (H:MM)
%speech% "What time will you be getting up tomorrow, sir?"
set /p alarmtime=(Current time is %time:~0,-6%) : 
echo Anything else you wish me to add to your wakeup for motivational purposes, sir?
%speech% "Anything else you wish me to add to your wakeup for motivational purposes, sir?"
set /p extramsg=Extra message (if not, leave empty):
echo.
echo Options:
echo 'No resume' (no)
echo 'Turn screen off' (off)
echo 'Dim the screen' (dim)
echo 'Start screensaver' (screen) 
set /p alarmoption=Choose an option:  
%speech% "Alarm set sir, goodnight.
echo.
echo Alarm set, sir. Goodnight. && echo.
echo Sleeping in 3...
ping 123.45.67.89 -n 1 -w 1000 > nul
echo Sleeping in 2...
ping 123.45.67.89 -n 1 -w 1000 > nul
echo Sleeping in 1...
ping 123.45.67.89 -n 1 -w 1000 > nul
if "%alarmoption%"=="dim" start scripts\dimscreen.exe
if "%alarmoption%"=="off" start scripts\nircmd.exe monitor off
if "%alarmoption%"=="screen" start scripts\nircmd.exe screensaver
cls
echo                                                     ----------------------- 
echo                                                       Logged in as: %username%
echo                                                     -----------------------
echo.
echo                                   J.A.R.V.I.S 
echo                                   -----------
echo                      Just a rather very intelligent system
echo                          ------      V%jarvisver%      ------
echo                                     -------
echo                                  STABLE VERSION
echo                                     -------
echo.
echo.
echo.         ____     ___                                                  
echo.        /\  _`\  /\_ \                          __                     
echo.        \ \ \ \_\\//\ \      __     __   _____ /\_\    ___      __     
echo.         \/_\__ \  \ \ \   / __ \ / __ \/\  __ \/\ \ /  _  \  / _  \   
echo.           /\ \ \ \ \_\ \_/\  __//\  __/\ \ \ \ \ \ \/\ \/\ \/\ \ \ \  
echo.           \ `\____\/\____\ \____\ \____\\ \  __/\ \_\ \_\ \_\ \____ \ 
echo.            \/_____/\/____/\/____/\/____/ \ \ \/  \/_/\/_/\/_/\/____\ \...
echo.                                           \ \_\                /\____/
echo.                                            \/_/                \_/__/ 
::if %alarmtime:~2,1% NEQ : (set alarmtime=0%alarmtime%)
:alarmcheck
if %time:~0,5%==%alarmtime% goto alarmplay
ping 123.45.67.89 -n 1 -w 60000 > nul
goto alarmcheck

:alarmplay
if %time:~0,-9% GTR 12 (set /a timehour=%time:~0,-9%-12) else set timehour=%time:~0,-9%
if %time:~3,1%==0 (set timeminute=%time:~4,1%) else set timeminute=%time:~3,2%
echo Good morning, sir. It is currently %timeminute% minutes past %timehour%. I would recommend getting out of bed now, sir. %extramsg%
%speech% "Good morning, sir. It is currently %timeminute% minutes past %timehour%. I would recommend getting out of bed now, sir. %extramsg%"
if "%alarmoption%"=="screen" start scripts\nircmd.exe monitor on
if "%alarmoption%"=="dim" taskkill /F /IM dimscreen.exe > nul
if "%alarmoption%"=="no" EXIT
set alarmoption=
cls
echo                                                     ----------------------- 
echo                                                       Logged in as: %username%
echo                                                     -----------------------
echo.
echo                                   J.A.R.V.I.S 
echo                                   -----------
echo                      Just a rather very intelligent system
echo                          ------      V%jarvisver%       ------
echo                                     -------
echo                                  STABLE VERSION
echo                                     -------
echo.
echo.
echo.
echo.
goto startonwake

:: Music

:Playlists
tree playlists /f
goto start

:mos
echo Buffering Ministry of Sound Radio now, sir.
start playlists\mos.vbs
goto start

:: /Music

:voicemode
echo Available voice profiles:
echo Windows (Default) [type "windows"]
echo J.A.R.V.I.S [type "jarvis"]
set /p voiceprofile=Please choose a voice profile:
if %voiceprofile%==windows set speech=scripts\nircmd.exe speak text
if %voiceprofile%==jarvis set speech=scripts\speech\swift.exe -d scripts\speech\lawrence -p speech/pitch/shift=0.8
echo Active Voice profile changed to %voiceprofile%.
goto newvoice

:Spotify
echo What would you like me to tell Spotify to do, sir? (experimental)
echo.
set /p spcom=
if %spcom%==play start scripts\spotify\spplaypause
if %spcom%==next start scripts\spotify\spnext
if %spcom%==previous start scripts\spotify\spprevious
if %spcom%==mute start scripts\spotify\spmute
if %spcom%==unmute start scripts\spotify\spmute
if %spcom%==jarvis goto jarvis
goto start

:lock
echo Locking my doors now, sir.
%speech% "Locking my doors now, sir."
set /a delay = %1 + 3
ping -n %delay% localhost > nul
rundll32.exe user32.dll, LockWorkStation
goto start

:msnstat
echo What would you like to set your messenger status to, sir?
echo (Choices are: available, busy, away or invisible)
echo.
set /p msnstatus=Set status to: 
if %msnstatus%==busy goto msnbusy
if %msnstatus%==available goto msnavail
if %msnstatus%==away goto msnaway
if %msnstatus%==invisible goto msninvis
pause

:msnbusy
echo.
"C:\program files\windows live\messenger\msnmsgr.exe" /busy
echo Your MSN status has now been changed to busy, sir.
goto start

:msnavail
echo.
"C:\program files\windows live\messenger\msnmsgr.exe" /available
echo Your MSN status has now been changed to available, sir.
goto start

:msnaway
echo.
"C:\program files\windows live\messenger\msnmsgr.exe" /away
echo Your MSN status has now been changed to away, sir.
goto start

:msninvis
echo.
"C:\program files\windows live\messenger\msnmsgr.exe" /invisible
echo Your MSN status has now been changed to invisible, sir.
goto start

:sendim
"C:\program files\windows live\messenger\msnmsgr.exe" /sendim
echo Instant Messenger window opened, sir.
goto start

:msnbrowse
start "C:\program files\windows live\messenger\msnmsgr.exe"
echo Instant Messenger contacts browser has been opened, sir.
goto start

:offout
echo Okay, sir. Have fun.
%speech% "Okay, sir. Have fun."
start scripts\dimscreen.exe
goto start

:imback
echo Hello again, sir. I hope you had a good time.
%speech% "Hello again, sir. I hope you had a good time."
taskkill /F /IM dimscreen.exe > nul
goto start

:killmos
taskkill /F /IM wmplayer.exe > nul
IF %ERRORLEVEL% EQU 0 echo Ministry of sound was successfully stopped.
echo.
goto start

:thankyou2
echo.
echo My pleasure, sir.
%speech% "My pleasure, sir."
goto start

:close
exit

:speak
set /p speechinput=Type a phrase to speak: 
if "%speechinput%"=="stop" goto start
echo %speechinput%
%speech% "%speechinput%"
goto speak

:version
VER | findstr /i "5.1." > nul
IF %ERRORLEVEL% EQU 0 %speech% You are running Windows XP, sir.
VER | findstr /i "6.1." > nul
IF %ERRORLEVEL% EQU 0 %speech% You are running Windows 7, sir.
goto start

:screenoff
start scripts\nircmd.exe cmdwait 2000 monitor off
goto start

:screensaver
start scripts\nircmd.exe screensaver
goto start

:dim
start scripts\dimscreen.exe
goto start

:dimstop
taskkill /IM dimscreen.exe
goto start

:weather
set /p wlocation= <scripts\weather\location.txt
start scripts\xml\getxml.exe -N --directory-prefix=%temp% %wlocation%
:weathercheck
if NOT EXIST %temp%\Next3DaysRSS.xml (
ping 123.45.67.89 -n 1 -w 500 > nul.
goto weathercheck
)
start scripts\weather\parsetoday.vbs
ping 123.45.67.89 -n 1 -w 500 > nul.
:weatherxmlparsecheck
if NOT EXIST %temp%\mintemp.txt (
ping 123.45.67.89 -n 1 -w 500 > nul.
goto weatherxmlparsecheck
)
set /p maxtemp= <%temp%\maxtemp.txt
set /p mintemp= <%temp%\mintemp.txt
set /p condition= <%temp%\condition.txt
echo.
echo The forecast for today is %condition% with highs of %maxtemp:~10% and lows of %mintemp:~10% degrees, sir.
%speech% "The forecast for today is %condition% with highs of %maxtemp:~10% and lows of %mintemp:~10% degrees, sir."
del %temp%\Next3DaysRSS.xml
del %temp%\forecast.txt
del %temp%\today.txt
del %temp%\condition.txt
del %temp%\maxtemp.txt
del %temp%\mintemp.txt
goto start

:forecast
set /p wlocation= <scripts\weather\location.txt
start scripts\xml\getxml.exe -N --directory-prefix=%temp% %wlocation%
:forecastcheck
if NOT EXIST %temp%\Next3DaysRSS.xml (
ping 123.45.67.89 -n 1 -w 500 > nul.
goto forecastcheck
)
start scripts\weather\parseforecast.vbs
ping 123.45.67.89 -n 1 -w 500 > nul.
:forecastxmlparsecheck
if NOT EXIST %temp%\mintemp2.txt (
ping 123.45.67.89 -n 1 -w 500 > nul.
goto forecastxmlparsecheck
)
set /p maxtemp= <%temp%\maxtemp.txt
set /p mintemp= <%temp%\mintemp.txt
set /p condition= <%temp%\condition.txt
set /p maxtemp2= <%temp%\maxtemp2.txt
set /p mintemp2= <%temp%\mintemp2.txt
set /p condition2= <%temp%\condition2.txt
set /p forecastday= <%temp%\day.txt
recho.
echo The forecast for tomorrow is %condition% with highs of %maxtemp:~10% and lows of %mintemp:~10% degrees, and for %forecastday% the forecast is %condition2% with highs of %maxtemp2:~10% and lows of %mintemp2:~10% degrees, sir.
%speech% "The forecast for tomorrow is %condition% with highs of %maxtemp:~10% and lows of %mintemp:~10% degrees, and for %forecastday% the forecast is %condition2% with highs of %maxtemp2:~10% and lows of %mintemp2:~10% degrees, sir."
del %temp%\Next3DaysRSS.xml
del %temp%\forecast.txt
del %temp%\tomorrow.txt
del %temp%\condition.txt
del %temp%\maxtemp.txt
del %temp%\mintemp.txt
del %temp%\aftertomorrow.txt
del %temp%\day.txt
del %temp%\condition2.txt
del %temp%\maxtemp2.txt
del %temp%\mintemp2.txt
goto start

:news
start scripts\xml\getxml.exe -N --directory-prefix=%temp% http://feeds.bbci.co.uk/news/rss.xml
:newscheck
if NOT EXIST %temp%\rss.xml (
ping 123.45.67.89 -n 1 -w 500 > nul.
goto newscheck
)
start scripts\news\parsebbcnews.vbs
ping 123.45.67.89 -n 1 -w 500 > nul.
:newsxmlparsecheck
if NOT EXIST %temp%\bbcnews.txt (
ping 123.45.67.89 -n 1 -w 500 > nul.
goto newsxmlparsecheck
)
set /p headline= <%temp%\bbcnews.txt
echo %headline%
%speech% "%headline%"
del %temp%\rss.xml
del %temp%\bbcnews.txt
goto start
